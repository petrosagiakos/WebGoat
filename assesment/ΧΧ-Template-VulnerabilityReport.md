
# 📄 Vulnerability Report - WebGoat

## 🔍 Εντοπισμένα Alerts

| Severity | Είδος Ευπάθειας     | Αρχείο                          | Περιγραφή                                      | Link στο CVE |
|----------|---------------------|----------------------------------|------------------------------------------------|----------------|
| Critical | [1] XXE(XML External Entity) #42     | src/main/java/org/owasp/webgoat/lessons/xxe/CommentsCache.java:79 | Resolving XML external entity in user-controlled data, an attacker could read local files and perform DoS attacks | [Alert](https://cwe.mitre.org/data/definitions/611.html)     |

| Critical | [2] Server-side request forgery  #41 | src/main/java/org/owasp/webgoat/lessons/ssrf/SSRFTask2.java:36        | Allows an attacker to make the server send HTTP requests to internal or external systems on their behalf. | [Alert](https://cwe.mitre.org/data/definitions/918.html)     |

| Critical     | [3]  Deserialization of user-controlled data  #40 | src/main/java/org/owasp/webgoat/lessons/vulnerablecomponents/VulnerableComponentsLesson.java:42 | Can execute arbitary code, elevate privilages and more through user input when its deserialized | [Alert](https://cwe.mitre.org/data/definitions/918.html   )     |

| Critical     | [4] Deserialization of user-controlled data #39 | src/main/java/org/owasp/webgoat/lessons/deserialization/InsecureDeserializationTask.java:45     | Can execute arbitary code, elevate privilages and more through user input when its deserialized | [Alert](https://cwe.mitre.org/data/definitions/502.html)     |

| High     | [5] Query built from user-controlled sources #57 | src/main/java/org/owasp/webgoat/lessons/sqlinjection/introduction/SqlInjectionLesson8.java:142        | Vulnerable to sql injection a malicious user could inject sql code into the action field     | [Alert](https://nvd.nist.gov/vuln/detail/CVE-2023-37197)     |

| High     | [6] Query built from user-controlled sources #56 | src/main/java/org/owasp/webgoat/lessons/sqlinjection/introduction/SqlInjectionLesson9.java:65          | Vulnerable to sql injection a malicious user could inject sql code into the action field     | [Alert](https://nvd.nist.gov/vuln/detail/CVE-2023-37197)     |
---

## 🛡️ Προτεινόμενα Μέτρα Αντιμετώπισης

### [1] SQL Injection
- Χρήση Prepared Statements αντί για δυναμικά queries.
- Αποφυγή εισαγωγής user input χωρίς έλεγχο τύπου/μορφής.

### [2] Command Injection
- Χρήση `ProcessBuilder` με αυστηρό έλεγχο ορίων εισόδου.
- Απομόνωση λειτουργιών κελύφους σε ασφαλές sandbox.

### [3] Path Traversal
- Κανονικοποίηση διαδρομών με `Paths.get(...).normalize()`.
- Περιορισμός προσβάσιμων καταλόγων με λευκή λίστα.

### [4] Cross-Site Scripting (XSS)
- Κωδικοποίηση χαρακτήρων στην HTML έξοδο (π.χ. με Apache Commons StringEscapeUtils).
- Χρήση HTTP headers για περιορισμό scripting (Content-Security-Policy).

### [5] Hardcoded Credentials
- Μεταφορά credentials σε περιβαλλοντικές μεταβλητές ή config αρχεία εκτός VCS.
- Χρήση vaults ή secrets management εργαλείων (π.χ. GitHub Secrets).

---

## 🔁 Κατάσταση μετά τη Διόρθωση

| Ευπάθεια | Κατάσταση | Σχόλιο |
|----------|-----------|--------|
| [1] SQL Injection | ✅ Fixed | Έγινε χρήση PreparedStatement. |
| [2] Command Injection | ✅ Fixed | Αφαιρέθηκε η χρήση `Runtime.exec`. |
| [3] Path Traversal | ✅ Fixed | Προστέθηκε έλεγχος με canonical path. |
| [4] XSS | ✅ Fixed | Εφαρμόστηκε HTML encoding. |
| [5] Hardcoded Credentials | ✅ Fixed | Μεταφέρθηκαν σε αρχείο `.env`. |

---

